{% comment %}
  Teste final - Adicione {% render 'test-fix-complete' %} ao template do produto
{% endcomment %}

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; margin: 10px 0; border-radius: 10px; font-family: Arial, sans-serif;">
  <h3 style="margin: 0 0 10px 0;">üéØ TESTE FINAL - Apenas Cores Filtradas</h3>
  
  {% if product %}
    <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; margin: 10px 0;">
      <strong>üì¶ Produto:</strong> {{ product.title }}<br>
      <strong>‚öôÔ∏è Configura√ß√£o:</strong> 
      {% if settings.hide_sold_out_variants %}
        <span style="background: #4caf50; padding: 2px 8px; border-radius: 3px;">‚úÖ ATIVADA</span>
      {% else %}
        <span style="background: #f44336; padding: 2px 8px; border-radius: 3px;">‚ùå DESATIVADA</span>
      {% endif %}
    </div>
    
    {% if product.options_with_values.size > 0 %}
      {% for option in product.options_with_values %}
        {%- assign color_keywords = 'color,colour,couleur,cor,colore,modelo,farbe,ÏÉâ,Ëâ≤,„Ç´„É©„Éº,f√§rg,farve,Escolha Sua Cor' | split: ',' -%}
        {%- assign downcase_option = option.name | downcase -%}
        {%- assign is_color_option = false -%}
        {%- if color_keywords contains downcase_option -%}
          {%- assign is_color_option = true -%}
        {%- endif -%}
        
        <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; margin: 5px 0;">
          <strong>{{ option.name }}:</strong>
          {% if is_color_option %}
            <span style="background: #ff9800; padding: 2px 6px; border-radius: 3px; font-size: 11px;">üé® COR</span>
          {% else %}
            <span style="background: #9e9e9e; padding: 2px 6px; border-radius: 3px; font-size: 11px;">üìè OUTRO</span>
          {% endif %}
          <br>
          
          <div style="margin: 5px 0;">
            <em>Comportamento atual:</em><br>
            {% if settings.hide_sold_out_variants and is_color_option %}
              {%- render 'filter-available-variants', option: option, product: product -%}
              {%- assign values_to_show = available_values -%}
              <span style="color: #ffeb3b;">üî• FILTRANDO CORES</span> - Mostrando {{ values_to_show.size }} de {{ option.values.size }} valores
            {% elsif settings.hide_sold_out_variants and is_color_option == false %}
              {%- assign values_to_show = option.values -%}
              <span style="color: #4caf50;">‚úÖ N√ÉO FILTRANDO</span> - Mostrando todos os {{ values_to_show.size }} valores (n√£o √© cor)
            {% else %}
              {%- assign values_to_show = option.values -%}
              <span style="color: #4caf50;">‚úÖ NORMAL</span> - Mostrando todos os {{ values_to_show.size }} valores (config desativada)
            {% endif %}
          </div>
          
          <div style="margin: 5px 0;">
            <em>Valores que aparecer√£o:</em><br>
            {% for value in values_to_show %}
              <span style="background: rgba(255,255,255,0.2); padding: 2px 6px; margin: 2px; border-radius: 2px; font-size: 12px;">{{ value }}</span>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    {% endif %}
    
    <div style="background: rgba(76, 175, 80, 0.2); padding: 10px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #4caf50;">
      <strong>‚úÖ NOVO COMPORTAMENTO:</strong><br>
      {% if settings.hide_sold_out_variants %}
        üé® <strong>CORES:</strong> Oculta apenas cores esgotadas<br>
        üìè <strong>TAMANHOS/OUTROS:</strong> Mostra sempre todos os valores
      {% else %}
        Funcionalidade desativada - mostra tudo normalmente
      {% endif %}
    </div>
    
    <div style="background: rgba(255, 193, 7, 0.2); padding: 10px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #ffc107;">
      <strong>üß™ COMO TESTAR:</strong><br>
      1. Verifique se op√ß√µes marcadas como üé® COR est√£o sendo filtradas<br>
      2. Verifique se op√ß√µes marcadas como üìè OUTRO mostram todos os valores<br>
      3. Ative/desative a configura√ß√£o e veja a diferen√ßa
    </div>
  {% else %}
    <p>‚ö†Ô∏è Este teste deve ser usado em uma p√°gina de produto</p>
  {% endif %}
</div>