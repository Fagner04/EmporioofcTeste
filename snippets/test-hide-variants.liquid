{% comment %}
  Snippet de teste para verificar se a funcionalidade de ocultar variantes esgotadas est√° funcionando
  Para usar: {% render 'test-hide-variants' %}
{% endcomment %}

<div style="background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; font-family: Arial, sans-serif;">
  <h3 style="margin: 0 0 10px 0; color: #333;">üîß Teste: Ocultar Variantes Esgotadas</h3>
  
  <p><strong>Configura√ß√£o atual:</strong> 
    {% if settings.hide_sold_out_variants %}
      <span style="color: green;">‚úÖ ATIVADO</span> - Variantes esgotadas ser√£o ocultadas
    {% else %}
      <span style="color: red;">‚ùå DESATIVADO</span> - Todas as variantes ser√£o exibidas
    {% endif %}
  </p>
  
  {% if product %}
    <p><strong>Produto:</strong> {{ product.title }}</p>
    <p><strong>Total de variantes:</strong> {{ product.variants.size }}</p>
    <p><strong>Variantes dispon√≠veis:</strong> 
      {% assign available_count = 0 %}
      {% for variant in product.variants %}
        {% if variant.available %}
          {% assign available_count = available_count | plus: 1 %}
        {% endif %}
      {% endfor %}
      {{ available_count }}
    </p>
    
    {% if product.options_with_values.size > 0 %}
      <div style="margin-top: 15px;">
        <h4 style="margin: 0 0 10px 0;">An√°lise por Op√ß√£o:</h4>
        {% for option in product.options_with_values %}
          <div style="background: white; padding: 10px; margin: 5px 0; border-radius: 3px;">
            <strong>{{ option.name }}:</strong><br>
            
            <div style="margin: 5px 0;">
              <em>Todos os valores ({{ option.values.size }}):</em><br>
              {% for value in option.values %}
                <span style="background: #e0e0e0; padding: 2px 6px; margin: 2px; border-radius: 2px; font-size: 12px;">{{ value }}</span>
              {% endfor %}
            </div>
            
            <div style="margin: 5px 0;">
              <em>Valores dispon√≠veis:</em><br>
              {% render 'filter-available-variants', option: option, product: product %}
              {% if available_values.size > 0 %}
                ({{ available_values.size }}) 
                {% for value in available_values %}
                  <span style="background: #d4edda; padding: 2px 6px; margin: 2px; border-radius: 2px; font-size: 12px; color: #155724;">{{ value }}</span>
                {% endfor %}
              {% else %}
                <span style="color: red;">Nenhum valor dispon√≠vel</span>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    
    <div style="margin-top: 15px; font-size: 12px; color: #666;">
      <strong>Como testar:</strong><br>
      1. V√° em Admin ‚Üí Produtos ‚Üí [Este produto]<br>
      2. Edite algumas variantes e marque como "Esgotado"<br>
      3. Volte √† p√°gina do produto e veja se as cores/tamanhos esgotados sumiram<br>
      4. Para desativar: Admin ‚Üí Temas ‚Üí Personalizar ‚Üí Produtos ‚Üí "Ocultar cores e tamanhos esgotados"
    </div>
  {% else %}
    <p style="color: red;">‚ö†Ô∏è Este snippet deve ser usado em uma p√°gina de produto</p>
  {% endif %}
</div>